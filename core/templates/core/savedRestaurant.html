<!-- savedRestaurant.html -->
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Saved Restaurants</title>
</head>
<style>
    ul {
            list-style-type: none;
            padding: 0;
            width: 100%; /* Adjust as needed */
            margin: 0 auto; /* Center the list */
        }
        li {
            display: flex;
            margin-bottom: 20px;
            border: 1px solid #ddd;
            padding: 10px;
            width: 100%;
        }
        .individualRestaurant {
            display: flex;
            flex-direction: column; /* Stacks items vertically */


        }
        img {
            max-width: 100%; /* Ensure image is responsive */
            height: auto;
        }
</style>
<body>
    <h1>Your Saved Restaurants</h1>
    <ul>
    {% if saved_restaurants %}
        {% for saved in saved_restaurants %}
            <li>
            <div class="individualRestaurant">
                <h2>{{ saved.restaurant.name }}</h2>
                {% if saved.restaurant.image %}
                    <img src="{{ saved.restaurant.image }}" alt="{{ saved.restaurant.name }}" style="width:200px; height:auto;">
                {% endif %}
                <p><strong>Address:</strong> {{ saved.restaurant.address }}</p>
                <p><strong>Rating:</strong> {{ saved.restaurant.rating }}</p>
                <button class="unsave-button" data-place-id="{{ saved.restaurant.place_id }}">Unsave</button>

            </div>
            </li>
        {% endfor %}
    {% else %}
        <p>No saved restaurants yet.</p>
    {% endif %}
    </ul>
<script>
    document.addEventListener('DOMContentLoaded', () => {
        // Get all unsave buttons
        const unsaveButtons = document.querySelectorAll('.unsave-button');

        unsaveButtons.forEach(button => {
            button.addEventListener('click', function () {
                const placeId = this.dataset.placeId;
                removee(placeId, this);
            });
        });
    });

    function removee(placeId, button) {
        fetch(`/unsave_restaurant/${placeId}/`, {
            method: 'POST',
            headers: {
                'X-CSRFToken': getCookie('csrftoken'), // Include the CSRF token for security
                'Content-Type': 'application/json'
            }
        })
        .then(response => {
            if (response.ok) {
                alert('Restaurant removed successfully!');
                // Remove the restaurant from the page
                const restaurantItem = button.closest('li');
                restaurantItem.remove();
            } else {
                alert('Error removing the restaurant.');
            }
        });
    }

    function getCookie(name) {
        let cookieValue = null;
        if (document.cookie && document.cookie !== '') {
            const cookies = document.cookie.split(';');
            for (let i = 0; i < cookies.length; i++) {
                const cookie = cookies[i].trim();
                if (cookie.substring(0, name.length + 1) === (name + '=')) {
                    cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
                    break;
                }
            }
        }
        return cookieValue;
    }
</script>

</body>
</html>

